import{h as g,u as y,e as k,r as d,a as l,i as C,k as S,j as e}from"./index-Dxf8ZwCd.js";import{g as P,O as E,C as B}from"./turn-back-DV8wNXkn.js";import{B as D}from"./Banner-D4IQ3Z-T.js";import{b as A}from"./banner-orders-JoudM5Ap.js";import{s as q,d as U}from"./orderUtils-DBNxGViL.js";import{S as _}from"./ScrollUpButton-C_-swsFs.js";import"./placeholder-ice-cream-CrNkbAc3.js";import"./OverlayPopup.styled-CfSgkfca.js";const F=()=>{const{id:m}=g(),o=y(),u=k(),[p,x]=d.useState(!1),[f,j]=d.useState(""),[v,I]=d.useState(""),t=l(s=>s.orders.selectedOrder),N=l(s=>s.orders.loading),i=l(s=>s.usersData.user),n=l(s=>s.user.user);d.useEffect(()=>{m&&o(C(m))},[m,o]),d.useEffect(()=>{t&&t.order.userId&&o(S(t.order.userId))},[t,o]),d.useEffect(()=>{i&&i._id},[i]),d.useEffect(()=>{t&&t.order.userId&&(n!=null&&n.id)&&t.order.userId!==n.id&&u("/orders")},[t,n,u]);const O=()=>{u("/orders")};if(N)return e.jsx("div",{children:"Loading..."});if(!t)return e.jsx("div",{children:"No order found"});const{order:r,orderItems:a}=t,h=()=>{x(!p)},b=()=>{j(r.number),I(r._id),h()};return e.jsxs("div",{className:"main",children:[e.jsx(D,{image:A,title:"Details de votre ",textPosition:"left",titleSpan:"commande",textColor:"white"}),e.jsxs("section",{className:"order-detail",children:[e.jsxs("div",{className:"order-container",children:[e.jsx("div",{className:"icon-open",onClick:O,children:e.jsx("img",{src:P,alt:"close"})}),e.jsxs("div",{className:"order-number",children:[e.jsxs("h3",{children:["#",r.number]}),e.jsxs("p",{children:["Date : ",new Date(r.createdAt).toLocaleDateString()]})]}),e.jsxs("div",{className:"order-main-info",children:[e.jsx("div",{className:"order-total",children:e.jsxs("div",{children:[e.jsxs("p",{children:["Coût total :"," ",e.jsxs("span",{className:"info-bold",children:[" ",a.reduce((s,c)=>s+c.quantity*c.stockItemId.pricePerUnit,0),"€"]})]}),e.jsxs("p",{children:["Quantité :"," ",e.jsxs("span",{className:"info-bold",children:[" ",a.reduce((s,c)=>s+c.quantity,0)*450/1e3," ","kg"]})]})]})}),e.jsxs("div",{className:"order-delivery-info",children:[e.jsxs("p",{className:"info-bold",children:[r.firstName," ",r.lastName,", ",r.mobilePhone]}),e.jsxs("p",{children:["Email :"," ",e.jsx("span",{className:"info-bold",children:i&&i.email?i.email:"Email non disponible"})]}),e.jsxs("p",{children:["Statut : ",q[r.status]||"Statut inconnu"]}),e.jsxs("p",{children:["Mode de livraison :"," ",U[r.deliveryOption]||"Option inconnue"]}),r.deliveryOption==="delivery"&&e.jsxs("p",{children:["Adresse de livraison :"," ",e.jsx("span",{className:"info-bold",children:r.deliveryAddress})]}),r.comment&&e.jsxs("p",{children:["Commantaire: ",r.comment]})]})]}),r.status=="pending"&&e.jsx("div",{className:"dashboard-order-modify-buttons",children:e.jsx("button",{onClick:b,id:"cancel-btn",children:"Annuler"})})]}),e.jsx("div",{className:"order-items-container",children:a&&a.length>0?a.map(s=>e.jsx(E,{title:s.stockItemId.title,category:s.stockItemId.category,price:s.stockItemId.pricePerUnit,quantity:s.quantity,image:s.stockItemId.image},s._id)):e.jsx("div",{children:"Aucun article dans la commande"})})]}),e.jsx(B,{orderId:v,orderNumber:f,isPopupOpen:p,closePopup:h}),e.jsx(_,{})]})};export{F as default};
