import{a as C,r as n,u as A,j as e,c as q,t as N,b as E,d as k,f as F,s as P}from"./index-D6-fVkmn.js";import{O as _}from"./OverlayPopup.styled-dVv7PbEb.js";import{i as O}from"./placeholder-ice-cream-CrNkbAc3.js";import{F as D,I as $}from"./ItemAddedToBasketNotification-bI3SmiXS.js";import{B as w}from"./Banner-BWHzXTgN.js";import{S as U}from"./ScrollUpButton-CLndXzxi.js";var z={BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const R=z.VITE_IMAGE_KEY,L=({isPopupOpen:r,closePopup:c,product:s,onAddToBasket:j})=>{const f=C(i=>i.basket.items),[o,l]=n.useState(1),x=A(),d=f.find(i=>i.id===s._id),h=d?d.quantity:0,a=s.quantity-h,u=i=>{i.target===i.currentTarget&&c()},v=()=>{l(i=>i<a?i+1:(N.error(`Vous ne pouvez pas ajouter plus de ${s.quantity} glaces ${s.title} à votre panier`),i))},g=()=>{o>1&&l(i=>i-1)},m=()=>{if(o>a){N.error(`La quantité demandée dépasse la limite de stock. Disponible: ${a}.`);return}const i={id:s._id,title:s.title,image:s.image,price:s.pricePerUnit,quantity:o};x(E(i)),j(i),c(),l(1)};return e.jsx(e.Fragment,{children:e.jsx(_,{onClick:u,children:e.jsxs("div",{className:`popup-container ${r?"open":"closed"}`,children:[e.jsx("div",{onClick:c,className:"icon-close",children:e.jsx("img",{src:q,alt:"close"})}),e.jsxs("div",{className:"product-popup-content",children:[e.jsxs("div",{className:"product-popup-main-content",children:[e.jsx("div",{className:"product-popup-main-content-img",children:e.jsx("img",{src:s.image?`${R}/${s.image}`:O,alt:s.title})}),e.jsxs("div",{className:"product-popup-main-content-text",children:[e.jsx("h3",{children:s.title}),e.jsx("p",{className:"flavor-category",children:s.category}),e.jsx("p",{className:"flavor-description",children:s.description}),e.jsx("div",{className:"flavor-size",children:e.jsx("p",{children:"Poids : 450 g"})})]})]}),e.jsxs("div",{className:"price-and-quantity",children:[e.jsx("div",{className:"price",children:e.jsxs("p",{children:[s.pricePerUnit*o," €"]})}),e.jsx("div",{className:"quantity",children:e.jsx("p",{children:o})}),e.jsxs("div",{className:"quantity-btn-container",children:[e.jsx("button",{className:"quantity-btn",onClick:v,children:"+"}),e.jsx("button",{className:"quantity-btn",onClick:g,children:"-"})]})]}),e.jsx("button",{className:"buy-btn",onClick:m,style:{padding:"8px 14px"},children:"Ajouter au panier"})]})]})})})},p=({category:r,isActive:c,onClick:s})=>e.jsx("div",{children:e.jsx("button",{className:`catalog-filter-btn ${c?"active":""}`,onClick:s,children:r})}),M="/assets/images/banner-catalog.png",b="/assets/images/banner-catalog-mobile.png",H=()=>{const[r,c]=n.useState(b),[s,j]=n.useState("Tous"),[f,o]=n.useState([]),[l,x]=n.useState(null),[d,h]=n.useState(!1),a=A(),{items:u,loading:v,error:g,selectedItem:m}=C(t=>t.stockItems);n.useEffect(()=>{a(k()),a(F())},[a]),n.useEffect(()=>{const t=()=>{window.innerWidth<=430?c(b):c(M)};return t(),window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[]),n.useEffect(()=>{if(s==="Tous")o(u);else{const t=u.filter(B=>B.category===s);o(t)}},[u,s]);const i=t=>{j(t)},I=t=>{a(P(t))},S=()=>{a(k())},T=()=>{h(!1),x(null)},y=t=>{x(t),h(!0)};return g?e.jsxs("div",{children:["Error: ",g]}):e.jsxs("div",{className:"main",children:[e.jsx(w,{image:r,title:"Bisous, ",textPosition:"center",titleSpan:"I love you!"}),e.jsxs("section",{className:"catalog",children:[e.jsxs("h2",{children:["NOS ",e.jsx("span",{children:"GOÛTS"})]}),e.jsxs("div",{className:"catalog-filters-bar",children:[e.jsx(p,{category:"Tous",isActive:s==="Tous",onClick:()=>i("Tous")}),e.jsx(p,{category:"Crème",isActive:s==="Crème",onClick:()=>i("Crème")}),e.jsx(p,{category:"Fruits",isActive:s==="Fruits",onClick:()=>i("Fruits")}),e.jsx(p,{category:"Noix",isActive:s==="Noix",onClick:()=>i("Noix")}),e.jsx(p,{category:"Fruits rouges",isActive:s==="Fruits rouges",onClick:()=>i("Fruits rouges")})]}),e.jsx("div",{className:"catalog-list",children:f.filter(t=>t.quantity>0).map(t=>e.jsx(D,{id:t._id,image:t.image,title:t.title,description:t.description,pricePerUnit:t.pricePerUnit,quantity:t.quantity,category:t.category,createdAt:t.createdAt,updatedAt:t.updatedAt,status:t.status,onClick:()=>I(t),onAddToBasket:y},t._id))}),m&&e.jsx(L,{isPopupOpen:!!m,closePopup:S,product:m,onAddToBasket:y}),d&&e.jsx($,{isPopupOpen:d,closePopup:T,item:l})]}),e.jsx(U,{})]})};export{H as default};
