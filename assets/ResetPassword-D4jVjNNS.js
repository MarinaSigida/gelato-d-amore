import{r as a,u as b,h as k,a as y,e as S,j as e,I as T,t as m}from"./index-DynBi6OI.js";import{F as z,a as E,b as p}from"./formik.esm-DN1cl7KR.js";import{s as w}from"./signup-background-mobile-DNGy0cJ-.js";import{h as u,s as g}from"./hide-DTZSLjd8.js";const I="/assets/images/banner-reset-password.jpg",V=()=>{const[h,n]=a.useState(w),[o,f]=a.useState(!1),[t,x]=a.useState(!1),j=b(),{resetToken:d}=k(),{loading:P,error:l,isAuthenticated:c}=y(s=>s.user),i=S();a.useEffect(()=>{const s=()=>{window.innerWidth<=430?n(w):n(I)};return s(),window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[]),a.useEffect(()=>{c&&i("/")},[c,i]);const v=async s=>{try{await j(T({resetToken:d,password:s.password})).unwrap(),console.log("resetToken",d),m.success("Votre mot de passe a été réinitialisé avec succès !"),i("/login")}catch(r){console.log(r),m.error("Une erreur est survenue lors de la réinitialisation du mot de passe.")}},N=s=>{const r=/^(?=.*[0-9])(?=.*[!@#$%^&*])(?=.{8,})/;if(s){if(!r.test(s))return"Le mot de passe doit contenir au moins 8 caractères, un chiffre, et un symbole"}else return"Le mot de passe est requis";return null};return e.jsx("div",{className:"main",children:e.jsxs("div",{className:"login-container",children:[e.jsx("div",{className:"login-background-image",style:{backgroundImage:`url(${h})`}}),e.jsx("div",{className:"login-form-wrapper",children:e.jsx(z,{initialValues:{password:"",confirmPassword:""},validate:s=>{const r={};return s.password!==s.confirmPassword&&(r.confirmPassword="Les mots de passe ne correspondent pas"),r},onSubmit:s=>v(s),children:({errors:s,touched:r})=>e.jsxs(E,{className:"login-form",children:[e.jsx("h3",{className:"form-header",children:"Veuillez créer un nouveau mot de passe"}),e.jsxs("div",{className:"login-inputs",children:[e.jsxs("div",{className:"login-input password-input-wrapper",children:[e.jsx(p,{type:o?"text":"password",name:"password",placeholder:"Votre mot de passe",validate:N,required:!0}),e.jsx("img",{src:o?u:g,className:"show-hide-password-icon",alt:"Toggle Password",onClick:()=>f(!o)})]}),s.password&&r.password&&e.jsx("p",{className:"form-error",children:s.password}),!s.password&&r.password&&e.jsx("p",{style:{color:"green",fontSize:"14px"},children:"Mot de passe valide ✅"}),e.jsxs("div",{className:"login-input password-input-wrapper",children:[e.jsx(p,{type:t?"text":"password",name:"confirmPassword",placeholder:"Confirmez votre mot de passe",required:!0}),e.jsx("img",{src:t?u:g,className:"show-hide-password-icon",alt:"Toggle Password",onClick:()=>x(!t)})]}),s.confirmPassword&&r.confirmPassword&&e.jsx("p",{className:"form-error",children:s.confirmPassword})]}),l&&e.jsx("p",{className:"form-error",style:{marginBottom:"40px"},children:l}),e.jsxs("button",{type:"submit",children:[" ",P?"Réinitialisation...":"Réinitialiser le mot de passe"]})]})})})]})})};export{V as default};
