import{r,u as b,h as y,a as k,e as S,j as e,I as T,t as l}from"./index-Dbl1aoQ1.js";import{F as z,a as E,b as m}from"./formik.esm-mwx-Xu0V.js";import{h as p,s as w}from"./hide-DTZSLjd8.js";const I="/assets/images/banner-reset-password.jpg",u="/assets/images/banner-mobile-reset-password.png",F=()=>{const[g,n]=r.useState(u),[o,h]=r.useState(!1),[t,f]=r.useState(!1),x=b(),{resetToken:P}=y(),{loading:j,error:d,isAuthenticated:c}=k(s=>s.user),i=S();r.useEffect(()=>{const s=()=>{window.innerWidth<=430?n(u):n(I)};return s(),window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[]),r.useEffect(()=>{c&&i("/")},[c,i]);const v=async s=>{try{await x(T({resetToken:P,password:s.password})).unwrap(),l.success("Votre mot de passe a été réinitialisé avec succès !"),i("/login")}catch{l.error("Une erreur est survenue lors de la réinitialisation du mot de passe.")}},N=s=>{const a=/^(?=.*[0-9])(?=.*[!@#$%^&*])(?=.{8,})/;if(s){if(!a.test(s))return"Le mot de passe doit contenir au moins 8 caractères, un chiffre, et un symbole"}else return"Le mot de passe est requis";return null};return e.jsx("div",{className:"main",children:e.jsxs("div",{className:"login-container",children:[e.jsx("div",{className:"login-background-image",style:{backgroundImage:`url(${g})`}}),e.jsx("div",{className:"login-form-wrapper",children:e.jsx(z,{initialValues:{password:"",confirmPassword:""},validate:s=>{const a={};return s.password!==s.confirmPassword&&(a.confirmPassword="Les mots de passe ne correspondent pas"),a},onSubmit:s=>v(s),children:({errors:s,touched:a})=>e.jsxs(E,{className:"login-form",children:[e.jsx("h3",{className:"form-header",children:"Veuillez créer un nouveau mot de passe"}),e.jsxs("div",{className:"login-inputs",children:[e.jsxs("div",{className:"login-input password-input-wrapper",children:[e.jsx(m,{type:o?"text":"password",name:"password",placeholder:"Votre mot de passe",validate:N,required:!0}),e.jsx("img",{src:o?p:w,className:"show-hide-password-icon",alt:"Toggle Password",onClick:()=>h(!o)})]}),s.password&&a.password&&e.jsx("p",{className:"form-error",children:s.password}),!s.password&&a.password&&e.jsx("p",{style:{color:"green",fontSize:"14px"},children:"Mot de passe valide ✅"}),e.jsxs("div",{className:"login-input password-input-wrapper",children:[e.jsx(m,{type:t?"text":"password",name:"confirmPassword",placeholder:"Confirmez votre mot de passe",required:!0}),e.jsx("img",{src:t?p:w,className:"show-hide-password-icon",alt:"Toggle Password",onClick:()=>f(!t)})]}),s.confirmPassword&&a.confirmPassword&&e.jsx("p",{className:"form-error",children:s.confirmPassword})]}),d&&e.jsx("p",{className:"form-error",style:{marginBottom:"40px"},children:d}),e.jsxs("button",{type:"submit",children:[" ",j?"Réinitialisation...":"Réinitialiser le mot de passe"]})]})})})]})})};export{F as default};
