import{r as n,e as y,u as v,a as F,j as e,z as I}from"./index-BIk-NbIX.js";import{F as N,a as D,b as o}from"./formik.esm-B4Fpz86f.js";import{B as w}from"./Banner-CxWdXLyf.js";import{b as u,a as P}from"./banner-dashboard-products-mobile-JLjYs1l0.js";import{i as d}from"./placeholder-ice-cream-CrNkbAc3.js";var S={BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const E=S.VITE_IMAGE_KEY,M=()=>{const[h,m]=n.useState(u),p=y(),x=v(),s=F(t=>t.stockItems.selectedItem),[i,g]=n.useState(null),[j,c]=n.useState(d);n.useEffect(()=>{s&&(g(s),c(s.image?`${E}/${s.image}`:d))},[s]),n.useEffect(()=>{const t=()=>{window.innerWidth<=430?m(u):m(P)};return t(),window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[]);const f=t=>{t.preventDefault(),p("/dashboard/stock")},b=(t,a)=>{const r=t.currentTarget.files[0];if(r){const l=new FileReader;l.onloadend=()=>{c(l.result),a("image",r)},l.readAsDataURL(r)}else c(d)},k=async t=>{const a=new FormData;a.append("title",t.title),a.append("category",t.category),a.append("description",t.description),a.append("quantity",t.quantity),a.append("pricePerUnit",t.pricePerUnit),a.append("status",t.status),a.append("image",t.image);try{await x(I({id:s._id,updatedItem:a})).unwrap(),p("/dashboard/stock")}catch(r){console.error("Failed to update item:",r)}};return i?e.jsxs("div",{className:"main",children:[e.jsx(w,{image:h,titleSpan:"Modifiez l'article",textColorExtra:"white",textPosition:"left"}),e.jsx("section",{className:"modify-stock-item",children:e.jsxs("div",{className:"add-stock-item-form-wrapper",children:[e.jsx("div",{className:"add-stock-item-form-image",children:e.jsx("img",{src:j,alt:"Stock Item"})}),e.jsx(N,{initialValues:{title:i.title||"",category:i.category||"",description:i.description||"",imgUrl:i.imgUrl||"",quantity:i.quantity||0,pricePerUnit:i.pricePerUnit||0,status:i.status||"",image:i.image||""},onSubmit:k,children:({setFieldValue:t})=>e.jsxs(D,{className:"add-stock-item-form",children:[e.jsx("label",{htmlFor:"title",children:"Nom de la glace"}),e.jsx("div",{className:"add-stock-item-input",children:e.jsx(o,{name:"title",type:"text",placeholder:"Nom de la glace"})}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"category",children:"Categorie de la glace"}),e.jsxs(o,{as:"select",name:"category",id:"option",required:!0,children:[e.jsx("option",{value:"Crème",label:"Crème"}),e.jsx("option",{value:"Fruits",label:"Fruits"}),e.jsx("option",{value:"Fruits rouges",label:"Fruits rouges"}),e.jsx("option",{value:"Noix",label:"Noix"})]})]}),e.jsx("label",{htmlFor:"description",children:"Description"}),e.jsx("div",{className:"add-stock-item-input",children:e.jsx(o,{name:"description",as:"textarea",placeholder:"Description"})}),e.jsx("label",{htmlFor:"image",children:"Image"}),e.jsx("div",{className:"add-stock-item-input",children:e.jsx("input",{name:"image",type:"file",accept:"image/*",onChange:a=>b(a,t)})}),e.jsx("label",{htmlFor:"quantity",children:"Quantité"}),e.jsx("div",{className:"add-stock-item-input",children:e.jsx(o,{name:"quantity",type:"number",placeholder:"Quantité"})}),e.jsx("label",{htmlFor:"pricePerUnit",children:"Prix"}),e.jsx("div",{className:"add-stock-item-input",children:e.jsx(o,{name:"pricePerUnit",type:"number",placeholder:"Prix"})}),e.jsxs("div",{className:"add-stock-item-form-buttons",children:[e.jsx("button",{onClick:f,children:"Annuler"}),e.jsx("button",{type:"submit",children:"Modifier"})]})]})})]})})]}):e.jsx("div",{children:"Loading..."})};export{M as default};
